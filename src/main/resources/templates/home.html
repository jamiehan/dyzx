<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>后台管理系统</title>
    <link rel="stylesheet" href="/layui/css/layui.css">
    <style>
        .layui-tab-title .layui-this{background-color:#009688;color:#eee;}.first-tab i.layui-tab-close{display:none !important;}.layui-layout-admin .layui-header{background-color:#1aa094 !important;}.layui-layout-admin .layui-logo{background-color:#0c0c0c !important;}.layuimini-color .color-title{padding:10px 0 10px 20px;border-bottom:1px solid #d9dada;margin-bottom:8px;}.layuimini-color .color-content{padding:0 5px 0 5px;}.layuimini-color .color-content ul{list-style:none;text-align:center;}.layuimini-color .color-content ul li{position:relative;display:inline-block;vertical-align:top;width:80px;height:50px;margin:0 15px 15px 0;padding:2px 2px 4px 2px;background-color:#f2f2f2;cursor:pointer;font-size:12px;color:#666;}.layuimini-color .color-content li.layui-this:after,.layuimini-color .color-content li:hover:after{width:100%;height:100%;padding:4px;top:-5px;left:-5px;border-color:#d8d8d8;opacity:1;}.layuimini-color .color-content li:after{content:'';position:absolute;z-index:20;top:50%;left:50%;width:1px;height:0;border:1px solid #f2f2f2;transition:all .3s;-webkit-transition:all .3s;opacity:0;}
        .layuimini-tool-left {position:absolute!important;top:0;left:200px;width:60px;height:100%;line-height:60px;text-align:center;color:#ffffff!important;}
        .closeBox {height:35px !important;}
        .closeBox > li {line-height:35px !important;}
        .closeBox {position:absolute;right: -10px;top: 16px;background-color:#fff !important;color:#000;border-bottom:1px solid #e2e2e2;padding:0 10px !important;}
        .closeBox .layui-nav-item {line-height:40px;}
        .closeBox .layui-nav-item > a,.closeBox .layui-nav-item > a:hover {color:#000;}
        .closeBox .layui-nav-child {top:40px;}
        .layui-layout-left {left: 0px;}
        .layui-body {left: 200px;margin-top: 5px;}
        .layui-nav {padding: 0 0px;}
        .layui-nav-alarm {left: 260px;}
        .layui-title {height: 60px; font-size:30px; padding: 0 15px; line-height: 60px; background-color: #330066!important; color: #ffffff;}
        .layui-layout-right {background-color: #330066!important;}
        .menu-layer {z-index: 10000}
        .home-robot-content {background-color: #330066;}
        .layui-container {width: 100%; padding: 0 0px;}
        .home-left-menu {margin-top: 60px;}
        .home-robot-list {height: 100%; padding: 0 5px;}
        .home-robot-list-title {color:#FFFFFF; margin-top:10px; padding: 0 5px;}
        .home-robot-info {height: 100%; padding: 0 5px;}

        .robot-control-body {background-color: #330066; bottom:0px;}
        .robot-control-main {margin-top:60px; }
        .robot-control-set {margin-top:30px; height:620px; background-color: #9F9F9F}
        .robot-control-box {padding: 2px 2px;}
        .home-robot-map-title {color:#FFFFFF; margin-top: 10px; padding: 0 5px;}
        .home-robot-map-show {height:620px;background-color: #9F9F9F; margin-left:5px; margin-right:0px;  padding: 0 0px;}
        .home-robot-map-show > div {height:100%; width: 100%}
        .home-robot-scene-title {color:#FFFFFF; margin-top: 10px; padding: 0 5px;}
        .home-robot-scene-show {height:620px;background-color: #000000; margin-left:5px; margin-right:0px; padding: 0 0px;}
        .home-robot-scene-show > img {width:100%; height:100%}
        .home-robot-scene-show > canvas {width:100%; height:100%}
        /*.home-robot-scene-show {height:420px;background-color: #000000;}*/
        .robot-control {height:638px;margin-top:10px; background-color: #9F9F9F;display: none}
        .layui-elem-field > legend {font-size: 14px}
        .camera-control-area {height:185px;}
        .camera-control-area-right {margin-bottom: 5px}
        .camera-ctrl-up {text-align: center}
        .camera-ctrl-left {text-align: center}
        .camera-ctrl-zoomin {text-align: center}
        .camera-ctrl-zoomout {text-align: center;margin-left: 1px;}
        .camera-ctrl-right {text-align: center}
        .camera-ctrl-center {margin-top: 5px;margin-bottom: 5px}
        .camera-ctrl-down {text-align: center}
        .camera-ctrl-speed {margin-top: 5px}
        .camera-ctrl-speed-selected {padding:0 2px}
        .camera-ctrl-btn {margin-top:2px}
        .robot-control-area {height:155px;}
        .robot-control-area-right {margin-bottom: 5px}
        .robot-ctrl-up {text-align: center}
        .robot-ctrl-middle {padding:2px 2px 2px 2px}
        .robot-ctrl-left {text-align: center}
        .robot-ctrl-center {text-align: center;}
        .robot-ctrl-right {text-align: center}
        .robot-ctrl-down {text-align: center}
        .robot-ctrl-btn {margin-left:5px; margin-top:2px; text-align: right}
        .cruise-control-area {height:120px;}
        .cruise-ctrl-up {margin-top:10px;text-align: left}
        .cruise-ctrl-up > select {width: 120px}
        .cruise-ctrl-down {margin-top:20px;text-align: left}
        .cruise-ctrl-down > input {height: 20px; width:120px}
        .cruise-control-area-right {margin-bottom: 5px}
        .cruise-ctrl-btn {margin-top:2px}
        .home-robot-monitoring-data {color:#FFFFFF; height:95px;display:none}
        .harmful-gas-area-left-down {margin-top:10px; margin-bottom:5px;color:#FFFFFF}
        .harmful-gas-area-input > input {height: 20px; width:50px}
        .harmful-gas-area-right {text-align:center;margin-bottom:5px;}
        .home-robot-rfid-alarm {margin-top:5px;height:90px;color:#FFFFFF;display:none}
        .home-robot-rfid-alarm-textarea > textarea {min-height: 50px;resize:none}
        .home-robot-status {margin-top:5px;height:80px;color:#FFFFFF}
        .layui-tree-txt {color:#FFFFFF}
        /*.custom-iframe {height: 800px}*/
        /*iframe {height: 100%}*/
        .layui-tab-content {
            padding: 0px;
        }

        /*.onekeyalarmdiv { width:600px;height: 500px;margin-top:200px;margin-left:200px;display:block;z-index:1000;background-color: #9F9F9F}*/
    </style>
    <style id="layuimini-bg-color">
    </style>
    <script>
        var g_SoftWareVersion="V4.03.R12.00014914.12012.142800.00200";
        var g_HardWareVersion="Unknown";
        var g_mBuildTime="2019/1/14 17:24:29";
        var g_SerialNo="230395345eb939be";
        var g_VideoInChannel=1;
        var g_AlarmInChannel=2;
        var g_AlarmOutChannel=1;
        var g_AudioInChannel=1;
        var g_DigChannel=0;


        var g_channelNumber=1;
        var g_user="admin";
        var g_port="554";
        var g_address =document.location.hostname;

        if (g_address == "")
        {

        }

        var iLanguage=101;
        var g_passWord="tlJwpbo6";


        var g_bSafari=false;
    </script>
</head>

<body class="layui-layout-body">
<div class="layui-layout layui-layout-admin">
    <div class="layui-title"><span onclick="backToHome()" style="cursor:pointer">东亚智星室外机器人管理系统</span>
        <!-- 头部区域（可配合layui已有的水平导航） -->
        <ul class="layui-nav layui-layout-right">
            <li class="layui-nav-item" lay-unselect>
                <a href="javascript:;" data-refresh="刷新"><i class="layui-icon layui-icon-refresh"></i></a>
            </li>
            <li class="layui-nav-item " lay-unselect>
                <a href="javascript:;" data-check-screen="full"><i class="layui-icon layui-icon-screen-full"></i></a>
            </li>
            <li class="layui-nav-item">
                <a href="javascript:;">
                    <div><span id="nickName">guest</span></div>
                </a>
                <dl class="layui-nav-child menu-layer">
                    <dd><a href="javascript:;" data-id="userProper" data-title="基本资料" data-url="/index/users/info"
                           class="menuNvaBar">基本资料</a></dd>
                    <dd><a href="javascript:;" data-id="userSafe" data-title="安全设置" data-url="/index/users/password"
                           class="menuNvaBar">更换密码</a></dd>
                    <dd><a href="javascript:;" id="logout">退出</a></dd>
                </dl>
            </li>
            <li class="layui-nav-item layuimini-select-bgcolor mobile layui-hide-xs" lay-unselect>
                <a href="javascript:;" data-bgcolor="配色方案"><i class="layui-icon layui-icon-more-vertical"></i></a>
            </li>
        </ul>
    </div>

    <div class="layui-header" id="layui-header">
        <div class="layui-logo" onload="iconHide()">欢迎进入机器人后台</div>
        <a>
            <div class="layuimini-tool-left"  onclick="iconHide()"><i class="icon-color layui-icon layui-icon-shrink-right" style="color:white" id="hide"></i></div>
        </a>
        <ul class="layui-nav layui-layout-left layui-nav-alarm">
            <li class="layui-nav-item"><button data-method="setOnekeyAlarmTop" class="layui-btn">一键报警</button></li>
            <li class="layui-nav-item"><button data-method="setFaceAlarmTop" class="layui-btn">人脸报警</button></li>
            <li class="layui-nav-item"><a href="">温湿度有害气体报警</a></li>
            <li class="layui-nav-item"><a href="">噪声报警</a></li>
            <li class="layui-nav-item"><a href="">安全帽报警</a></li>
            <li class="layui-nav-item"><a href="">异物报警</a></li>
            <li class="layui-nav-item"><a href="">火源报警</a></li>
            <li class="layui-nav-item"><a href="">指示灯报警</a></li>
            <li class="layui-nav-item"><a href="">热成像报警</a></li>
            <li class="layui-nav-item"><a href="">RFID报警</a></li>
        </ul>
    </div>


    <!-- 左侧菜单-->

    <div id="mainmenu" class="layui-side layui-bg-black home-left-menu">
        <div class="layui-side-scroll">
            <div class="navBar layui-side-scroll" id="navBarId">

            </div>
        </div>
    </div>


    <div class="layui-body">


        <div class="layui-tab" lay-filter="tab" lay-allowclose="true">
            <ul class="layui-tab-title" style="width: 90%">
                <li class="first-tab layui-this"><i class="layui-icon layui-icon-home"></i> <span>主页</span></li>
            </ul>
            <ul class="layui-nav closeBox">
                <li class="layui-nav-item">
                    <a href="javascript:;"> <i class="layui-icon layui-icon-circle-dot"></i> 页面操作</a>
                    <dl class="layui-nav-child">
                        <dd><a href="javascript:;" data-page-close="other"><i class="layui-icon layui-icon-close"></i> 关闭其他</a></dd>
                        <dd><a href="javascript:;" data-page-close="all"><i class="layui-icon layui-icon-close-fill"></i> 关闭全部</a></dd>
                    </dl>
                </li>
            </ul>
            <div class="layui-tab-content">
                <div class="layui-tab-item layui-show">
                    <iframe th:src="@{/index/main}" frameborder="0" name="content" width="100%" height="100%" id="home"></iframe>
                </div>
            </div>
        </div>

    </div>

</div>
</body>
<!--
<div class="layui-container robot-control">
    <div class="layui-row ">
        <div class="layui-col-md6">
            <div class="layui-row">
                <div class="layui-col-md3 home-robot-list">
                    <div class="home-robot-list-title">
                        机器人列表
                    </div>
                    <div id="test1" class="demo-tree demo-tree-box">tree</div>
                </div>
                <div class="layui-col-md9 home-robot-map">
                    <div class="layui-row home-robot-map-title">地图</div>
                    <div class="layui-row home-robot-map-show"></div>
                </div>
            </div>

        </div>
        <div class="layui-col-md6">
            <div class="layui-row home-robot-window">
                <div class="layui-col-md8 home-robot-scene">
                    <div class="layui-row home-robot-scene-title">镜头
                    </div>
                    <div class="layui-row home-robot-scene-show"></div>
                </div>
                <div class="layui-col-md4 home-robot-control">
                    <div class="layui-row camera-control-area">
                        <fieldset class="layui-elem-field">
                            <legend>摄像头控制</legend>
                            <div class="layui-field-box">
                                <div class="layui-col-md9 camera-control-area-left">
                                    <div class="layui-row camera-ctrl-up">
                                        <button type="button" class="layui-btn layui-btn-sm layui-btn-normal">上</button>
                                    </div>
                                    <div class="layui-row camera-ctrl-center">
                                        <div class="layui-col-md4 camera-ctrl-left"><button type="button" class="layui-btn layui-btn-sm layui-btn-normal">左</button></div>
                                        <div class="layui-col-md4">&nbsp;</div>
                                        <div class="layui-col-md4 camera-ctrl-right"><button type="button" class="layui-btn layui-btn-sm layui-btn-normal">右</button></div>
                                    </div>
                                    <div class="layui-row camera-ctrl-down">
                                        <button type="button" class="layui-btn layui-btn-sm layui-btn-normal">下</button>
                                    </div>
                                    <div class="layui-row camera-ctrl-speed">
                                        <div class="layui-col-md6 camera-ctrl-speed-title">云台速度</div>
                                        <div class="layui-col-md6 camera-ctrl-speed-selected">
                                            <select name="robot-speed">
                                                <option value="1" selected="">1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                                <option value="4">4</option>
                                                <option value="5">5</option>
                                                <option value="6">6</option>
                                                <option value="7">7</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-col-md3 camera-control-area-right">
                                    <div class="layui-rows camera-ctrl-btn"><button type="button" class="layui-btn layui-btn-sm layui-btn-normal">开始作业</button></div>
                                    <div class="layui-rows camera-ctrl-btn"><button type="button" class="layui-btn layui-btn-sm layui-btn-normal">&nbsp;关&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;闭&nbsp;</button></div>
                                    <div class="layui-rows camera-ctrl-btn"><button type="button" class="layui-btn layui-btn-sm layui-btn-normal">&nbsp;刷&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;新&nbsp;</button></div>
                                    <div class="layui-rows camera-ctrl-btn"><button type="button" class="layui-btn layui-btn-sm layui-btn-normal">开始录制</button></div>
                                </div>
                            </div>
                        </fieldset>
                    </div>
                    <div class="layui-row robot-control-area">
                        <fieldset class="layui-elem-field">
                            <legend>机器人控制</legend>
                            <div class="layui-field-box">
                                <div class="layui-col-md7 robot-control-area-left">
                                    <div class="layui-row robot-ctrl-up">
                                        <button type="button" class="layui-btn layui-btn-sm layui-btn-normal">前进</button>
                                    </div>
                                    <div class="layui-row robot-ctrl-middle">
                                        <div class="layui-col-md4 robot-ctrl-left"><button type="button" class="layui-btn layui-btn-sm layui-btn-normal">左转</button></div>
                                        <div class="layui-col-md4 robot-ctrl-center"><button type="button" class="layui-btn layui-btn-sm layui-btn-normal">停止</button></div>
                                        <div class="layui-col-md4 robot-ctrl-right"><button type="button" class="layui-btn layui-btn-sm layui-btn-normal">右转</button></div>
                                    </div>
                                    <div class="layui-row robot-ctrl-down">
                                        <button type="button" class="layui-btn layui-btn-sm layui-btn-normal">后退</button>
                                    </div>
                                </div>
                                <div class="layui-col-md5 robot-control-area-right">
                                    <div class="layui-rows robot-ctrl-btn"><button type="button" class="layui-btn layui-btn-sm layui-btn-normal">&nbsp;充&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;电&nbsp;</button></div>
                                    <div class="layui-rows robot-ctrl-btn"><button type="button" class="layui-btn layui-btn-sm layui-btn-normal">&nbsp;抓&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;拍&nbsp;</button></div>
                                    <div class="layui-rows robot-ctrl-btn"><button type="button" class="layui-btn layui-btn-sm layui-btn-normal">查看历史抓拍</button></div>
                                </div>
                            </div>
                        </fieldset>
                    </div>
                    <div class="layui-row cruise-control-area">
                        <fieldset class="layui-elem-field">
                            <legend>设置巡航方案</legend>
                            <div class="layui-field-box">
                                <div class="layui-col-md9 cruise-control-area-left">
                                    <div class="layui-row cruise-ctrl-up">
                                        <select name="" lay-verify="required">
                                            <option value=""></option>
                                        </select>
                                    </div>
                                    <div class="layui-row cruise-ctrl-down">
                                        <input type="text" name="title" required  lay-verify="required" placeholder="" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-col-md3 cruise-control-area-right">
                                    <div class="layui-rows cruise-ctrl-btn"><button type="button" class="layui-btn layui-btn-sm layui-btn-normal">获取位置</button></div>
                                    <div class="layui-rows cruise-ctrl-btn"><button type="button" class="layui-btn layui-btn-sm layui-btn-normal">单点巡航</button></div>
                                    <div class="layui-rows cruise-ctrl-btn"><button type="button" class="layui-btn layui-btn-sm layui-btn-normal">多点巡航</button></div>
                                </div>
                            </div>
                        </fieldset>
                    </div>

                </div>
            </div>
        </div>
            <div class="layui-row home-robot-monitoring-data">
                <fieldset class="layui-elem-field">
                    <legend>温湿度有害气体</legend>
                    <div class="layui-field-box">
                        <div class="layui-col-md11 harmful-gas-area-left">
                            <div class="layui-row harmful-gas-area-left-up">
                                <div class="layui-col-md6">
                                    <div class="layui-row">
                                        <div class="layui-col-md2">异味值：</div>
                                        <div class="layui-col-md1">&nbsp;</div>
                                        <div class="layui-col-md1">PM2.5:</div>
                                        <div class="layui-col-md1">&nbsp;</div>
                                        <div class="layui-col-md1">ug/m2</div>
                                        <div class="layui-col-md2">CO(煤气)：</div>
                                        <div class="layui-col-md1">&nbsp;&nbsp;&nbsp;&nbsp;ppm</div>
                                        <div class="layui-col-md1">甲烷：</div>
                                        <div class="layui-col-md1">&nbsp;</div>
                                        <div class="layui-col-md1">ppm</div>
                                    </div>
                                </div>
                                <div class="layui-col-md6">
                                    <div class="layui-row">
                                        <div class="layui-col-md1">甲醛：</div>
                                        <div class="layui-col-md1">&nbsp;</div>
                                        <div class="layui-col-md1">ppm</div>
                                        <div class="layui-col-md1">PM10:</div>
                                        <div class="layui-col-md1">&nbsp;</div>
                                        <div class="layui-col-md1">ug/m2</div>
                                        <div class="layui-col-md2">温度：</div>
                                        <div class="layui-col-md1">&nbsp;</div>
                                        <div class="layui-col-md2">湿度：</div>
                                        <div class="layui-col-md1">&nbsp;</div>
                                    </div>
                                </div>
                            </div>
                            <div class="layui-row harmful-gas-area-left-down">
                                <div class="layui-col-md1">电量：</div>
                                <div class="layui-col-md7">&nbsp;</div>
                                <div class="layui-col-md1">温度阈值</div>
                                <div class="layui-col-md1 harmful-gas-area-input">
                                    <input type="text" name="title" lay-verify="required" placeholder="" autocomplete="off" class="layui-input">
                                </div>
                                <div class="layui-col-md1">湿度阈值</div>
                                <div class="layui-col-md1 harmful-gas-area-input">
                                    <input type="text" name="title" required  lay-verify="required" placeholder="" autocomplete="off" class="layui-input">
                                </div>
                            </div>
                        </div>
                        <div class="layui-col-md1 harmful-gas-area-right">
                            <div class="layui-rows cruise-ctrl-btn"><button type="button" class="layui-btn layui-btn-sm layui-btn-normal">设置阈值</button></div>
                            <div class="layui-rows cruise-ctrl-btn"><button type="button" class="layui-btn layui-btn-sm layui-btn-normal">发送阈值</button></div>
                        </div>
                    </div>
                </fieldset>
            </div>
            <div class="layui-row home-robot-rfid-alarm">
                <fieldset class="layui-elem-field">
                    <legend>RFID报警信息</legend>
                    <div class="layui-field-box home-robot-rfid-alarm-textarea">
                        <textarea name="rfidAlarmInfo" rows="2" placeholder="" class="layui-textarea"></textarea>
                    </div>
                </fieldset>
            </div>
            <div class="layui-row home-robot-status">
                <fieldset class="layui-elem-field">
                    <legend>机器人状态</legend>
                    <div class="layui-field-box">
                        <div class="layui-row">
                            <div class="layui-col-md1">机器人编号：</div>
                            <div class="layui-col-md1">&nbsp;</div>
                            <div class="layui-col-md1">传感器板：</div>
                            <div class="layui-col-md1">&nbsp;</div>
                            <div class="layui-col-md1">右电机板：</div>
                            <div class="layui-col-md1">&nbsp;</div>
                            <div class="layui-col-md1">左电机板：</div>
                            <div class="layui-col-md1">&nbsp;</div>
                            <div class="layui-col-md1">无线板：</div>
                            <div class="layui-col-md1">&nbsp;</div>
                            <div class="layui-col-md1">电源板</div>
                            <div class="layui-col-md1">&nbsp;</div>
                        </div>
                        <div class="layui-row">
                            <div class="layui-col-md1">深度摄像头：</div>
                            <div class="layui-col-md1">&nbsp;</div>
                            <div class="layui-col-md1">激光：</div>
                            <div class="layui-col-md1">&nbsp;</div>
                            <div class="layui-col-md1">陀螺仪：</div>
                            <div class="layui-col-md1">&nbsp;</div>
                            <div class="layui-col-md1">CAN模块：</div>
                            <div class="layui-col-md1">&nbsp;</div>
                            <div class="layui-col-md1">互联网：</div>
                            <div class="layui-col-md1">&nbsp;</div>
                            <div class="layui-col-md1">里程计：</div>
                            <div class="layui-col-md1">&nbsp;</div>
                        </div>
                    </div>
                </fieldset>
            </div>
    </div>

</div>
-->

<script src="/layui/layui.all.js"></script>
<script src="/js/core.util.js"></script>
<script src="/js/jquery.js"></script>
<script src="/js/home.js?v=0.1"></script>

<!-- jQuery -->
<script type="text/javascript" src="/js/jquery-1.10.2.min.js"></script>

<!-- KinectJS -->
<script type="text/javascript" src="/js/kinetic-v5.1.0.min.js"></script>

<!-- ROS stuff -->
<script type="text/javascript" src="/js/easeljs.min.js"></script>
<script type="text/javascript" src="/js/easeljs.js"></script>
<script type="text/javascript" src="/js/eventemitter2.min.js"></script>
<script type="text/javascript" src="/js/mjpegcanvas.min.js"></script>
<script type="text/javascript" src="/js/nav2d.js"></script>
<script type="text/javascript" src="/js/ros2d.js"></script>
<script type="text/javascript" src="/js/jsmpeg.min.js"></script>
<script type="text/javascript" src="/js/mt.js"></script>
<script type="text/javascript" src="/js/SimpChinese.js"></script>
<script src="/js/roslib.min.js"></script>
<script src="/js/robot_gui.js"></script>


<script>
    var layer = layui.layer;
    var $ = jQuery = layui.jquery;
    var form = layui.form;
    var element = layui.element;
    initBgColor();
    // init();
    // init_ros();

    var backToHome = function() {
        window.location.href = "/index/home"
    };

    $(function () {

        // CoreUtil.sendGet2("http://192.168.1.102:8080/stream?topic=/camera/color/image_raw", null, function (res) {
        //     alert(res);
        //     // var data = res.data;
        //     // $("#videoCanvas").append(data);
        //     // alert("1111");
        // });

        FrameWH();
        //递归获取导航栏无线层级
        var getChild = function (item, ulHtml) {
            ulHtml += '<dl class="layui-nav-child">';
            $.each(item, function (index, child) {
                if (child.children != null && child.children.length > 0 && child.type == 1) {
                    ulHtml += '<dd><a>' + child.title + '</a>';
                    ulHtml += getChild(child.children, "");
                } else if (child.children != null && child.children.length > 0 && child.type != 1) {
                    ulHtml += '<a>' + child.title + '</a>';
                    ulHtml += getChild(child.children, "");
                } else {
                    if (child.target == "_blank") {
                        ulHtml += '<dd><a href="' + child.url + '" target="_blank">';
                    } else {
                        ulHtml += '<dd><a href="javascript:;" data-icon="' + child.icon + '" data-url="' + child.url + '" data-title="' + child.title + '" data-id="' + child.id + '" class="menuNvaBar">';
                    }
                    ulHtml += '<cite>' + child.title + '</cite></a></dd>';
                }
                if (child.children != null && child.children.length > 0 && child.type == 1) {
                    ulHtml += '</dd>';
                }

            });
            ulHtml += "</dl>"
            return ulHtml;
        };
        CoreUtil.sendGet("/sys/home/", null, function (res) {
            $("#deptName").html("所属部门: " + res.data.userInfo.deptName);
            $("#nickName").html(res.data.userInfo.username);
            var data = res.data.menus;
            if (data != "" && data.length > 0) {
                var ulHtml = '<ul class="layui-nav layui-nav-tree layui-left-nav" onclick="ulHide()">';
                // var ulHtml = '<ul class="layui-nav layui-layout-left"  onclick="ulHide()">';
                if (data != null && data.length > 0) {

                    $.each(data, function (index, item) {
                        if (index == 0) {
                            ulHtml += '<li class="layui-nav-item layui-nav-itemed">';
                        } else {
                            ulHtml += '<li class="layui-nav-item">';
                        }
                        ulHtml += '<a href="javascript:;">';
                        if (!CoreUtil.isEmpty(item.icon)) {
                            ulHtml += '<i class="layui-icon '+item.icon+'"></i>';
                        }
                        ulHtml += '<cite> ' + item.title + '</cite>';
                        ulHtml += '</a>'
                        if (item.children != null && item.children.length > 0) {
                            ulHtml += '<dl class="layui-nav-child">';
                            $.each(item.children, function (index, child) {
                                if (child.children != null && child.children.length > 0 && child.type == 1) {
                                    ulHtml += '<dd><a>' + child.title + '</a>';
                                    ulHtml += getChild(child.children, "");
                                } else if (child.children != null && child.children.length > 0 && child.type != 1) {
                                    ulHtml += '<a>' + child.tit武le + '</a>';
                                    ulHtml += getChild(child.children, "");
                                } else {
                                    if (child.target == "_blank") {
                                        ulHtml += '<dd><a href="' + child.url + '" target="_blank">';
                                    } else {
                                        ulHtml += '<dd><a href="javascript:;" data-icon="' + child.icon + '" data-url="' + child.url + '" data-title="' + child.title + '" data-id="' + child.id + '" class="menuNvaBar">';
                                    }
                                    if (!CoreUtil.isEmpty(child.icon)) {
                                        ulHtml += '<i class="layui-icon '+child.icon+'"></i>';
                                    }
                                    ulHtml += '<cite> ' + child.title + '</cite></a></dd>';
                                }

                                if (child.children != null && child.children.length > 0 && child.type == 1) {
                                    ulHtml += '</dd>';
                                }

                            });
                            ulHtml += "</dl>"
                        }
                        ulHtml += '</li>'
                    });
                }
                ulHtml += '</ul>';
                $(".navBar").append(ulHtml);
                // $(".layui-header").append(ulHtml);
                element.init();  //初始化页面元素

            } else {
                $("#navBarId").empty();
            }

            top.layer.closeAll();
        });
        $(document).on('click', '.menuNvaBar', function () {
            var dataid = $(this);
            if ($(".layui-tab-title li[lay-id]").length <= 0) {
                if (CoreUtil.isEmpty(dataid.attr("data-icon"))){
                    var title = "<span>"+dataid.attr("data-title")+"</span>";
                    active.tabAdd(dataid.attr("data-url"), dataid.attr("data-id"), title);
                } else {
                    var title = "<span>"+dataid.attr("data-title")+"</span>";
                    title = '<i class="layui-icon '+dataid.attr("data-icon")+'"></i> ' + title;
                    active.tabAdd(dataid.attr("data-url"), dataid.attr("data-id"), title);
                }
            } else {
                var isData = false;
                $.each($(".layui-tab-title li[lay-id]"), function () {
                    if ($(this).attr("lay-id") == dataid.attr("data-id")) {
                        isData = true;
                    }
                })
                if (isData == false) {
                    if (CoreUtil.isEmpty(dataid.attr("data-icon"))){
                        var title = "<span>"+dataid.attr("data-title")+"</span>";
                        active.tabAdd(dataid.attr("data-url"), dataid.attr("data-id"), title);
                    } else {
                        var title = "<span>"+dataid.attr("data-title")+"</span>";
                        title = '<i class="layui-icon '+dataid.attr("data-icon")+'"></i> ' + title;
                        active.tabAdd(dataid.attr("data-url"), dataid.attr("data-id"), title);
                    }
                }
            }
            active.tabChange(dataid.attr("data-id"));
        });

        //退出登录
        $("#logout").click(function () {
            logoutDialog();
        });
    });
    //删除前确认对话框
    var logoutDialog = function () {
        layer.open({
            content: '确定要退出登录么？',
            yes: function (index, layero) {
                layer.close(index); //如果设定了yes回调，需进行手工关闭
                CoreUtil.sendGet("/sys/user/logout", null, function (res) {
                    layui.data('LocalData', null);
                    top.window.location.href = "/index/login";
                });
            }
        });
    }
    //触发事件
    var active = {
        tabAdd: function (url, id, title) {
            if (url != "" && url != null && url != undefined) {
                element.tabAdd('tab', {
                    title: title
                    ,
                    content: '<iframe data-frameid="' + id + '" frameborder="0" name="content" width="100%" src="' + url + '"></iframe>'
                    ,
                    id: id
                })
            }
            FrameWH();//计算框架高度
        },
        tabChange: function (id) {
            //切换到指定Tab项
            element.tabChange('tab', id); //切换到：用户管理
            $("iframe[data-frameid='" + id + "']").attr("src", $("iframe[data-frameid='" + id + "']").attr("src"))//切换后刷新框架
        },
        tabDelete: function (id) {
            element.tabDelete("tab", id);//删除
        }
    };

    function FrameWH() {
        var h = $(window).height() - 41 - 10 - 35 - 10 - 44 - 10;
        $("iframe").css("height", h + "px");
    };

    // var canvas = document.getElementById('video');
    // var url = 'ws://127.0.0.1:8080/videostream';
    // var player = new JSMpeg.Player(url, {canvas: canvas});


    layui.use('layer', function(){ //独立版的layer无需执行这一句
        var $ = layui.jquery, layer = layui.layer; //独立版的layer无需执行这一句

        //触发事件
        var active = {
            setOnekeyAlarmTop: function(){
                var that = this;
                //多窗口模式，层叠置顶
                layer.open({
                    type: 2 //此处以iframe举例
                    ,title: '一键报警'
                    ,offset: 'auto'
                    ,area: ['390px', '260px']
                    ,shade: 0
                    ,maxmin: true
                    // ,offset: [ //为了演示，随机坐标
                    //     Math.random()*($(window).height()-300)
                    //     ,Math.random()*($(window).width()-390)
                    // ]
                    // ,content: '//layer.layui.com/test/settop.html'
                    ,content: '/index/onekeyalarm'
                    // ,btn: ['继续弹出', '全部关闭'] //只是为了演示
                    ,btn:['关闭窗口']
                    // ,yes: function(){
                    //     $(that).click();
                    // }
                    ,btn2: function(){
                        // layer.closeAll();
                        layer.close();
                    }

                    ,zIndex: layer.zIndex //重点1
                    ,success: function(layero){
                        layer.setOnekeyAlarmTop(layero); //重点2
                    }
                });
            }
            ,setFaceAlarmTop: function(){
                var that = this;
                //多窗口模式，层叠置顶
                layer.open({
                    type: 2 //此处以iframe举例
                    ,title: '人脸报警'
                    ,offset: 'auto'
                    ,area: ['1200px', '600px']
                    ,shade: 0
                    ,maxmin: true
                    // ,offset: [ //为了演示，随机坐标
                    //     Math.random()*($(window).height()-300)
                    //     ,Math.random()*($(window).width()-390)
                    // ]
                    // ,content: '//layer.layui.com/test/settop.html'
                    ,content: '/index/facealarm'
                    // ,btn: ['继续弹出', '全部关闭'] //只是为了演示
                    ,btn:['关闭窗口']
                    // ,yes: function(){
                    //     $(that).click();
                    // }
                    ,btn2: function(){
                        // layer.closeAll();
                        layer.close();
                    }

                    ,zIndex: layer.zIndex //重点1
                    ,success: function(layero){
                        layer.setTop(layero); //重点2
                    }
                });
            }
            ,confirmTrans: function(){
                //配置一个透明的询问框
                layer.msg('大部分参数都是可以公用的<br>合理搭配，展示不一样的风格', {
                    time: 20000, //20s后自动关闭
                    btn: ['明白了', '知道了', '哦']
                });
            }
            ,notice: function(){
                //示范一个公告层
                layer.open({
                    type: 1
                    ,title: false //不显示标题栏
                    ,closeBtn: false
                    ,area: '300px;'
                    ,shade: 0.8
                    ,id: 'LAY_layuipro' //设定一个id，防止重复弹出
                    ,btn: ['火速围观', '残忍拒绝']
                    ,btnAlign: 'c'
                    ,moveType: 1 //拖拽模式，0或者1
                    ,content: '<div style="padding: 50px; line-height: 22px; background-color: #393D49; color: #fff; font-weight: 300;">你知道吗？亲！<br>layer ≠ layui<br><br>layer只是作为Layui的一个弹层模块，由于其用户基数较大，所以常常会有人以为layui是layerui<br><br>layer虽然已被 Layui 收编为内置的弹层模块，但仍然会作为一个独立组件全力维护、升级。<br><br>我们此后的征途是星辰大海 ^_^</div>'
                    ,success: function(layero){
                        var btn = layero.find('.layui-layer-btn');
                        btn.find('.layui-layer-btn0').attr({
                            href: 'http://www.layui.com/'
                            ,target: '_blank'
                        });
                    }
                });
            }
            ,offset: function(othis){
                var type = othis.data('type')
                    ,text = othis.text();

                layer.open({
                    type: 1
                    ,offset: type //具体配置参考：http://www.layui.com/doc/modules/layer.html#offset
                    ,id: 'layerDemo'+type //防止重复弹出
                    ,content: '<div style="padding: 20px 100px;">'+ text +'</div>'
                    ,btn: '关闭全部'
                    ,btnAlign: 'c' //按钮居中
                    ,shade: 0 //不显示遮罩
                    ,yes: function(){
                        layer.closeAll();
                    }
                });
            }
        };

        $('#layui-header .layui-btn').on('click', function(){
            var othis = $(this), method = othis.data('method');
            active[method] ? active[method].call(this, othis) : '';
        });

    });







</script>

</html>