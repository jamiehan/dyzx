<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" src="/js/pcmplayer.js"></script>
</head>
<body>
<button onclick="loadPCM()">接警</button>
<input type="range" max="20" value="10" min="0" id="range" onchange="changeVolume(event)" step="0.1"><br />
<!--
<button onclick="pause()">暂停</button>
<button onclick="continuePlay()">继续</button>
-->
<script>
    let player
    function loadPCM() {
        // 这是我搭载自己服务器上的server端，用来接收pcm数据
        // 如果起了example里面的本地server端，改成对应的ws地址就行了
        // var socketURL = 'wss://pkjy.xyz/websocket';
        var socketURL = 'ws://127.0.0.1:8080/onekeyalarm';

        player = new PCMPlayer({
            inputCodec: 'Int8', //Int16
            channels: 1, //2
            sampleRate: 11025, //8000
            flushTime: 1000
        });

        var ws = new WebSocket(socketURL);

        ws.binaryType = 'arraybuffer';
        // ws.onopen;
        ws.addEventListener('message', function (event) {
            // 可以传 ArrayBuffer 或者 任意TypedArray
            player.feed(event.data);
        });
    }

    function changeVolume(e) {
        player.volume(document.querySelector('#range').value)
    }
    async function pause() {
        await player.pause()
    }
    function continuePlay() {
        player.continue()
    }
</script>
</body>
</html>